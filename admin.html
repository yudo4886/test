<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ìˆœì°° ê´€ë¦¬ì íŒ¨ë„</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f4f7f6; }
        .log-card { background: white; border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 12px; display: flex; gap: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .thumb { width: 150px; height: 150px; object-fit: cover; border-radius: 8px; border: 1px solid #eee; }
        .info { flex: 1; }
        .badge { display: inline-block; background: #e74c3c; color: white; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: bold; margin-bottom: 8px; }
        .time { color: #888; font-size: 13px; }
        h1 { color: #2c3e50; }
    </style>
</head>
<body>
    <h1>ğŸ“‹ ìˆœì°° ê¸°ë¡ í†µí•© ê´€ë¦¬ì</h1>
    <div id="log-list">ê¸°ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
    const BASE_URL = https://xdncwblakjxpddyywnzb.supabase.co; 
    const SUPABASE_KEY = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhkbmN3Ymxha2p4cGRkeXl3bnpiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAyNDMwNjIsImV4cCI6MjA4NTgxOTA2Mn0.CzDrVfnJIoUziM28k8WUH0_yrJ3Ai-21x-d7SwngJww;
    const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        async function fetchLogs() {
            const { data, error } = await supabase
                .from('patrol_records')
                .select('*')
                .order('created_at', { ascending: false });

            const listEl = document.getElementById('log-list');
            if (error) { listEl.innerText = "ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤."; return; }
            if (data.length === 0) { listEl.innerText = "ì €ì¥ëœ ìˆœì°° ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤."; return; }

            listEl.innerHTML = data.map(log => `
                <div class="log-card">
                    <a href="${log.photo_url}" target="_blank">
                        <img src="${log.photo_url}" class="thumb">
                    </a>
                    <div class="info">
                        <div class="time">${new Date(log.created_at).toLocaleString()}</div>
                        <h3 style="margin: 5px 0;">[${log.mode}] ìˆœì°° ê¸°ë¡</h3>
                        <p style="margin: 5px 0;">ğŸ“ ${log.address}</p>
                        <p style="margin: 5px 0; color: #666;">â± ê²½ê³¼ ì‹œê°„: ${log.duration}</p>
                        ${log.report_type ? `
                            <div style="margin-top:10px; padding:10px; background:#fff5f5; border-radius:8px;">
                                <span class="badge">${log.report_type}</span><br>
                                <strong>ë‚´ìš©:</strong> ${log.report_text}
                            </div>
                        ` : ""}
                    </div>
                </div>
            `).join('');
        }
        window.onload = fetchLogs;
    </script>
</body>
</html>